<%@ page language="java" contentType="text/html; charset=UTF-8"
	pageEncoding="UTF-8"%>
<%@ taglib uri="http://java.sun.com/jsp/jstl/core" prefix="c"%>
<%@ taglib uri="http://java.sun.com/jsp/jstl/fmt" prefix="fmt"%>
<%@ taglib uri="http://www.springframework.org/security/tags" prefix="sec"%>
<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>메디폼 │ 행정관리자</title>
<style type="text/css">
#header {
	font-weight: bold;
}

.text-nowrap {
	cursor: pointer;
}

#msgArea {
	font-size: 17px;
	margin-bottom: 50px;
}

#empSelectBox, #conSelectBox, #comSelectBox  {
	margin-left: auto;
	margin-top: 20px;
	width: 150px;
	height: 35px;
}

#empSearchBox {
	margin-top: 18px;
	margin-right: 8px;
}

.subMenu:hover {
	border-color: #3f51b5;
 	background-color: rgba(63, 81, 181, 0.1);
}

.subMenu {
	font-size: 16px;
	margin-left : 20px;
	margin-right : 20px; 
}

.profileImg {
	width: 150px; /* 원하는 가로 크기로 설정 */
 	height: 150px; /* 원하는 세로 크기로 설정 */
  	object-fit: cover; /* 이미지 비율 유지하면서 부족한 부분을 채움 */
}

</style>
</head>
<body>
<!-- 서브 메뉴 -->            
<ul class="navbar-nav d-flex flex-row" style="margin-bottom: 15px; border-bottom: 1px solid #ededed; border-top: 1px solid #ededed;">
	<li style="margin-left:15px;"></li>
    <li class="subMenu nav-item">
      <a class="nav-link" href="/mediform/manager/employee/select" role="button" id="employeeManagementBtn"> 　직원 관리　</a>
    </li>
    <li class="subMenu nav-item">
      <a class="nav-link" href="/mediform/manager/employee/select/chart" role="button" id="employeeOrganizationChartBtn">　직원 조직도　</a>
    </li>
</ul>
<!-- 서브 메뉴 -->            




      
	<input type="hidden" id="thisPage" value="${thisPage }">
	<input type="hidden" id="msg" value="${msg }">
	<!-- ////////////////////// 탭 구현 시작 ///////////////////////// -->
	<div class="col-xl-12 ps-xl-2">
		<div class="card mb-3 h-100">
			<div class="card-header bg-body-tertiary" style="border-bottom: 1px solid #ededed;">
				<div class="row flex-between-end">
					<div class="col-auto align-self-center">
						<h4 class="mb-0" id="headerText" style="font-weight: bold;">
							<input type="hidden" value="${flagSelect }" id="flagSelect">
							<input type="hidden" value="${pagingVO.currentPage }" id="currentPage">
							<c:choose>
								<c:when test="${flagSelect eq 'employee' }">
									직원 목록
								</c:when>
								<c:when test="${flagSelect eq 'confirm' }">
									신청 내역
								</c:when>
								<c:when test="${flagSelect eq 'complete' }">
									처리 내역
								</c:when>
								
							</c:choose>
						</h4>
					</div>
					<div class="col-auto ms-auto">
						<div class="nav nav-pills nav-pills-falcon flex-grow-1"
							role="tablist">
							<button class="btn btn-sm <c:if test="${flagSelect eq 'employee' }">active</c:if>" data-bs-toggle="pill"
								data-bs-target="#dom-657bd836-7d4e-4254-89a8-7136482499e7"
								type="button" role="tab"
								aria-controls="dom-657bd836-7d4e-4254-89a8-7136482499e7"
								aria-selected="true"
								id="employee2">직원 조회</button>
							<button class="btn btn-sm <c:if test="${(flagSelect eq 'confirm') or (flag eq 'confirm') }">active</c:if>" data-bs-toggle="pill"
								data-bs-target="#dom-9e7952b7-b2ff-4974-9cd2-96ba32df3067"
								type="button" role="tab"
								aria-controls="dom-9e7952b7-b2ff-4974-9cd2-96ba32df3067"
								aria-selected="false"
								id="confirm">신청 내역</button>
							<button class="btn btn-sm <c:if test="${flagSelect eq 'complete' }">active</c:if>" data-bs-toggle="pill"
								data-bs-target="#dom-9e7952b7-b2ff-4974-9cd2-96ba32df3069"
								type="button" role="tab"
								aria-controls="dom-9e7952b7-b2ff-4974-9cd2-96ba32df3069"
								aria-selected="false"
								id="complete">처리 내역</button>
						</div>
					</div>
				</div>
			</div>
			<div class="card-body bg-body-tertiary">
				<div class="tab-content">
					<div class="tab-pane preview-tab-pane <c:if test="${flagSelect eq 'employee' }">active</c:if>" role="tabpanel"
						aria-labelledby="tab-dom-657bd836-7d4e-4254-89a8-7136482499e7"
						id="dom-657bd836-7d4e-4254-89a8-7136482499e7">
						<div class="card overflow-hidden" style="width: 100%;">
							<!--  //////////////// 직원 조회 시작////////////////// -->
							<div class="table-responsive scrollbar">
							
						
							
							<div style="display: flex; justify-content: flex-end;">
							    <form action="/mediform/manager/employee/select" method="post" id="empListForm" style="display: flex;">
							        <div class="search-box" id="empSearchBox" style="display: flex;">
							            <input class="searchInput form-control search-input fuzzy-search" type="search" placeholder="직원명이나 사번을 입력해 주세요." aria-label="Search" id="empSearchInput" style="flex: 1;" value="${pagingVO.searchWord }" name="searchWord"/>
							            <span class="fas fa-search search-box-icon"></span>
							            <div class="btn-close-falcon-container position-absolute end-0 top-50 translate-middle shadow-none" data-bs-dismiss="search">
							                <button class="btn btn-link btn-close-falcon p-0" aria-label="Close"></button>
							            </div>
							        </div>
							        <input type="hidden" name="page" id="empPage" />
							        <input type="hidden" name="listType" value="employee" id="listTypeInput">
							        <select class="form-select form-select-sm" aria-label=".form-select-sm example" id="empSelectBox" name="searchType">
							            <option <c:if test="${searchType eq 'default'}">selected</c:if> value="default" >전체</option>
							            <option <c:if test="${searchType eq 'a'}">selected</c:if> value="a">원무</option>
							            <option <c:if test="${searchType eq 'd'}">selected</c:if> value="d">의사</option>
							            <option <c:if test="${searchType eq 'n'}">selected</c:if> value="n">간호</option>
							            <option <c:if test="${searchType eq 't'}">selected</c:if> value="t">치료</option>
							            <option <c:if test="${searchType eq 'm'}">selected</c:if> value="m">관리</option>
							            <option <c:if test="${searchType eq 'r'}">selected</c:if> value="r">퇴직</option>
							        </select>
							        <sec:csrfInput />
							    </form>
							</div>
							
							
							<hr/>
								<table class="table table-hover table-striped overflow-hidden">
									<thead>
										<tr style="margin-bottom: 20px;">
											<th scope="col">이름</th>
											<th scope="col">사번</th>
											<th scope="col">소속</th>
											<th scope="col">이메일</th>
											<th scope="col">연락처</th>
											<th scope="col">입사일자</th>
										</tr>
									</thead>
									<tbody>
										<!-- 넘어온 값 셋팅 -->
										<c:set value="${pagingVO.dataList }" var="empList"/>
										<c:choose>
											<c:when test="${empty empList }">
												<tr class="align-middle" id="">
													<td class="text-center" colspan="5">등록된 직원 내역이 없습니다.</td>
												</tr>
											</c:when>
											<c:otherwise>
												<c:forEach items="${empList }" var="emp">
													<tr class="selectDetail align-middle" id="${emp.empNo }">
														<td class="text-nowrap">${emp.empNm }</td>
														<td class="text-nowrap">${emp.empNo }</td>
														<td class="text-nowrap"><c:choose>
																<c:when test="${emp.empSe eq 'n'}">간호</c:when>
																<c:when test="${emp.empSe eq 'a'}">원무</c:when>
																<c:when test="${emp.empSe eq 'd'}">전문</c:when>
																<c:when test="${emp.empSe eq 't'}">치료</c:when>
																<c:when test="${emp.empSe eq 'm'}">관리</c:when>
																<c:when test="${emp.empSe eq 'k'}">병원장</c:when>
															</c:choose></td>
														<td class="text-nowrap" >${emp.empEmail }</td>
														<td class="text-nowrap">${emp.empTelno }</td>
														<td class="text-nowrap">
															<fmt:formatDate value="${emp.empRgsde }" pattern="yyyy-MM-dd HH:mm:ss" />
														</td>
													</tr>
												</c:forEach>
											</c:otherwise>
										</c:choose>
									</tbody>
								</table>
							</div>
							<div class="card-footer clearfix col-auto align-self-center pagingArea">
								${pagingVO.pagingHTML }
							</div>
							<!--  //////////////// 직원 조회 끝////////////////// -->
						</div>
					</div>
					
					
					<div class="tab-pane code-tab-pane <c:if test="${flagSelect eq 'confirm' or (flag eq 'confirm') }">active</c:if>" role="tabpanel"
						aria-labelledby="tab-dom-9e7952b7-b2ff-4974-9cd2-96ba32df3067"
						id="dom-9e7952b7-b2ff-4974-9cd2-96ba32df3067">
						<div class="card overflow-hidden" style="width: 100%;">
							
							<!--  //////////////// 신청 내역 시작////////////////// -->
							<div class="table-responsive scrollbar">
							<div style="display: flex; justify-content: flex-end;">
								<form action="/mediform/manager/employee/select" method="post" id="confirmListForm" style="display: flex;">
									<!-- 검색창 -->
									<div class="search-box" id="empSearchBox" style="display: flex;">
	<!-- 								  <form class="position-relative" data-bs-toggle="search" data-bs-display="static"> -->
									    <input class="confirmSearchInput form-control search-input fuzzy-search" type="search" style="flex: 1;" placeholder="직원명이나 사번을 입력해 주세요." aria-label="Search" id="conSearchInput" name="searchWord" value="${pagingVO.searchWord }"/>
									    <span class="fas fa-search search-box-icon"></span>
	<!-- 								  </form> -->
									  <div class="btn-close-falcon-container position-absolute end-0 top-50 translate-middle shadow-none" data-bs-dismiss="search">
									    <button class="btn btn-link btn-close-falcon p-0" aria-label="Close"></button>
									  </div>
									</div>
									<input type="hidden" name="page" id="conPage" />
									<input type="hidden" name="listType" value="confirm" >
									<!-- 셀렉트박스 -->
									<select class="form-select form-select-sm" aria-label=".form-select-sm example" id="conSelectBox" name="searchType">
									    <option selected="selected" value="default">신청내역</option>
									</select>
									<sec:csrfInput />
								</form>
							</div>
							
								<table class="table table-hover table-striped overflow-hidden">
									<thead>
										<tr>
											<th scope="col">이름</th>
											<th scope="col">소속</th>
											<th scope="col">신청일자</th>
											<th scope="col">등록자명</th>
										</tr>
									</thead>
									<tbody>
										<c:set value="${pagingVO.dataList }" var="confirmList"/>
										<c:choose>
											<c:when test="${empty confirmList }">
												<tr class="align-middle" id="">
													<td class="text-center" colspan="5">회원가입을 신청한 내역이 없습니다.</td>
												</tr>
											</c:when>
											<c:otherwise>
												<c:forEach items="${confirmList }" var="confirm">
													<tr class="detail align-middle" id="${confirm.empNo }">
														<td class="text-nowrap">${confirm.empNm }</td>
														<td class="text-nowrap"><c:choose>
																<c:when test="${confirm.empSe eq 'n'}">간호</c:when>
																<c:when test="${confirm.empSe eq 'a'}">원무</c:when>
																<c:when test="${confirm.empSe eq 'd'}">전문</c:when>
																<c:when test="${confirm.empSe eq 't'}">치료</c:when>
																<c:when test="${confirm.empSe eq 'm'}">관리</c:when>
																<c:when test="${confirm.empSe eq 'k'}">병원장</c:when>
															</c:choose></td>
														<td class="text-nowrap">
															<fmt:formatDate value="${confirm.empRgsde }" pattern="yyyy-MM-dd HH:mm:ss" />
														</td>
														<td class="text-nowrap">오호</td>
													</tr>
												</c:forEach>
											</c:otherwise>
										</c:choose>
									</tbody>
								</table>
							</div>
							<div class="card-footer clearfix col-auto align-self-center pagingArea">
								${pagingVO.pagingHTML }
							</div>
							<!--  //////////////// 신청 내역 끝////////////////// -->
						</div>
					</div>
					<div class="tab-pane code-tab-pane <c:if test="${flagSelect eq 'complete' }">active</c:if>" role="tabpanel"
						aria-labelledby="tab-dom-9e7952b7-b2ff-4974-9cd2-96ba32df3069"
						id="dom-9e7952b7-b2ff-4974-9cd2-96ba32df3069">
						<div class="card overflow-hidden" style="width: 100%;">
							<!--  //////////////// 처리 내역 시작////////////////// -->
							<div class="table-responsive scrollbar">
								<div style="display: flex; justify-content: flex-end;">
									<form action="/mediform/manager/employee/select" method="post" id="completeListForm" style="display: flex;">
										<!-- 검색창 -->
										<div class="search-box" id="empSearchBox" style="display: flex;">
		<!-- 								  <form class="position-relative" data-bs-toggle="search" data-bs-display="static"> -->
										    <input class="completeSearchInput form-control search-input fuzzy-search" type="search" placeholder="직원명이나 사번을 입력해 주세요." aria-label="Search" id="comSearchInput" style="flex: 1;" name="searchWord" value="${pagingVO.searchWord }"/>
										    <span class="fas fa-search search-box-icon"></span>
		<!-- 								  </form> -->
										  <div class="btn-close-falcon-container position-absolute end-0 top-50 translate-middle shadow-none" data-bs-dismiss="search">
										    <button class="btn btn-link btn-close-falcon p-0" aria-label="Close"></button>
										  </div>
										  
										</div>
										<input type="hidden" name="page" id="comPage" />
										<input type="hidden" name="listType" value="complete">
										<!-- 셀렉트박스 -->
										<select class="form-select form-select-sm" aria-label=".form-select-sm example" id="comSelectBox" name="searchType">
										    <option <c:if test="${searchType eq 'default'}">selected</c:if> value="default">전체 내역</option>
										    <option <c:if test="${searchType eq 'yes'}">selected</c:if> value="yes">승인 내역</option>
										    <option <c:if test="${searchType eq 'no'}">selected</c:if> value="no">반려 내역</option>
										</select>
										<sec:csrfInput />
									</form>
								</div>
								<table class="table table-hover table-striped overflow-hidden">
										<thead>
											<tr>
												<th scope="col">이름</th>
												<th scope="col">성별</th>
												<th scope="col">이메일</th>
												<th scope="col">연락처</th>
												<th scope="col">소속</th>
												<th scope="col">신청일자</th>
												<th scope="col">승인내역</th>
											</tr>
										</thead>
										<tbody>
											<c:set value="${pagingVO.dataList }" var="comfirmList"/>
											<c:choose>
												<c:when test="${empty confirmList }">
													<tr class="align-middle" id="">
														<td class="text-center" colspan="5">회원가입을 신청한 내역이
															없습니다.</td>
													</tr>
												</c:when>
												<c:otherwise>
													<c:forEach items="${comfirmList }" var="complete">
														<tr class="completeDetail align-middle" id="${complete.empNo }">
															<td class="text-nowrap">${complete.empNm }</td>
															<td class="text-nowrap">
																<c:if test="${complete.empSexdstn eq 'M' }">남성</c:if>
																<c:if test="${complete.empSexdstn eq 'F' }">여성</c:if>
															</td>
															<td class="text-nowrap">${complete.empEmail }</td>
															<td class="text-nowrap">${complete.empTelno }</td>
															<td class="text-nowrap"><c:choose>
																	<c:when test="${complete.empSe eq 'n'}">간호</c:when>
																	<c:when test="${complete.empSe eq 'a'}">원무</c:when>
																	<c:when test="${complete.empSe eq 'd'}">전문</c:when>
																	<c:when test="${complete.empSe eq 't'}">치료</c:when>
																	<c:when test="${complete.empSe eq 'm'}">관리</c:when>
																	<c:when test="${complete.empSe eq 'k'}">병원장</c:when>
																</c:choose></td>
															<td class="text-nowrap">
																<fmt:formatDate value="${complete.empRgsde }" pattern="yyyy-MM-dd HH:mm:ss" />
															</td>
															<td class="text-nowrap">
																<c:if test="${complete.empConfm eq 'Y'}">승인</c:if>
																<c:if test="${complete.empConfm eq 'N'}">반려</c:if>
															</td>
														</tr>
													</c:forEach>
												</c:otherwise>
											</c:choose>
										</tbody>
									</table>
								</div>
								<div class="card-footer clearfix col-auto align-self-center pagingArea">
									${pagingVO.pagingHTML }
								</div>
								</div>
							
							<!--  //////////////// 처리 내역 끝////////////////// -->
						</div>
					</div>
				</div>
			</div>
		</div>
	
	<!-- ////////////////////// 탭 구현 끝 ///////////////////////// -->

	<!-- 1 직원 내역 모달 탬플릿 시작 -->
	<div class="modal fade" id="memberDetail-modal" tabindex="-1"
		role="dialog" aria-hidden="true">
		<div class="modal-dialog modal-dialog-centered" role="document"
			style="max-width: 500px">
			<div class="modal-content position-relative">
				<div class="position-absolute top-0 end-0 mt-2 me-2 z-1">
					<button
						class="btn-close btn btn-sm btn-circle d-flex flex-center transition-base"
						data-bs-dismiss="modal" aria-label="Close"></button>
				</div>
				<div class="modal-body p-0">
					<div class="rounded-top-3 py-3 ps-4 pe-6 bg-body-tertiary">
						<h4 class="modalHeader mb-1" id="modalExampleDemoLabel">직원내역 상세보기</h4>
					</div>
					<div class="p-4 pb-0">
						<div class="text-center">
	                    	<img class="profileImg rounded-circle img-thumbnail shadow-sm" width="150" height="150" src="/resources/image/profile/profileImg.png" alt="User profile picture" id="empProfile">
	                    </div>
						<div class="mb-3 form-group">
							<label class="col-form-label" for=empNoInput>사번</label> <input
								class="form-control" id="empNoInput" type="text" name=""
								readonly="readonly" />
						</div>
						<div class="mb-3 form-group">
							<label class="col-form-label" for=empNm>이름</label> <input
								class="form-control" id="empNm" type="text" name=""
								readonly="readonly" />
						</div>
						<div class="mb-3 form-group">
							<label class="col-form-label" for="empSe">소속</label> <input
								class="form-control" id="empSe" type="text" name=""
								readonly="readonly" />
						</div>
						<div class="mb-3 form-group">
							<label class="col-form-label" for="empEncpn">입사일자</label> 
							<input class="form-control" id="empEncpn" type="text" name="" readonly="readonly" />
						</div>
						<div class="mb-3 form-group">
							<label class="col-form-label" for="empRrno">주민등록번호</label> <input
								class="form-control" id="empRrno" type="text" name=""
								readonly="readonly" />
						</div>
						<div class="mb-3 form-group">
							<label class="col-form-label" for="empTelno">연락처</label> <input
								class="form-control" id="empTelno" type="text" name=""
								readonly="readonly" />
						</div>
						<div class="mb-3 form-group">
							<label class="col-form-label" for="empAdres">주소</label> <input
								class="form-control" id="empAdres" type="text" name=""
								readonly="readonly" />
						</div>
						<div class="mb-3 form-group">
							<label class="col-form-label" for="empSexdstn">성별</label> <input
								class="form-control" id="empSexdstn" type="text" name=""
								readonly="readonly" />
						</div>
						<div class="mb-3 form-group">
							<label class="col-form-label" for="empEmailInput">이메일</label> <input
								class="form-control" id="empEmailInput" type="text"
								name="empEmail" readonly="readonly" />
						</div>
						<div class="mb-3 form-group">
							<!-- 수정 폼 -->
							<form action="/mediform/manager/employee/update" method="post" id="modifyForm" enctype="application/x-www-form-urlencoded">
								<input type="hidden" id="empNoUpdate" name="empNo" value="">
								<input type="hidden" id="empSeUpdate" name="empSe" value="">
					        	<label class="col-form-label" for="empClsf">직급</label> <br>
                				<input class="form-check-input" id="empClsf1" type="radio" name="empClsf" value="1" > 일반 사원 <br>
                				<input class="form-check-input" id="empClsf0" type="radio" name="empClsf" value="0" > 과장 <br><br>
                				
								<label class="col-form-label" for="empHffcAt">재직 여부</label> <br>
								<input class="form-check-input" id="retireCheckboxO" type="radio" name="empHffcAt" value="Y" /> Y <br>
								<input class="form-check-input" id="retireCheckboxX" type="radio" name="empHffcAt" value="N" /> N <br>
								<sec:csrfInput />
							</form>
						</div>
						<div class="mb-3 form-group">
							<label class="col-form-label" for="empRetireInput">퇴직 일자</label>
							<input class="form-control" id="empRetireInput" type="text" name="" readonly="readonly"/>
						</div>
					</div>
				</div>
				<div class="modal-footer">
					<button class="btn btn-secondary" type="button" id="modifyEmpBtn">수정</button>
					<button class="btn btn-primary" type="button" id=""
						data-bs-dismiss="modal">닫기</button>
				</div>
			</div>
		</div>
	</div>
	<!-- 1 직원 내역 모달 탬플릿 끝 -->
	
	<!-- 2 신청 내역 모달 탬플릿 시작 -->
	<div class="modal fade" id="confirmDetail-modal" tabindex="-1"
		role="dialog" aria-hidden="true">
		<div class="modal-dialog modal-dialog-centered" role="document"
			style="max-width: 500px">
			<div class="modal-content position-relative">
				<div class="position-absolute top-0 end-0 mt-2 me-2 z-1">
					<button
						class="btn-close btn btn-sm btn-circle d-flex flex-center transition-base"
						data-bs-dismiss="modal" aria-label="Close"></button>
				</div>
				<div class="modal-body p-0">
					<div class="rounded-top-3 py-3 ps-4 pe-6 bg-body-tertiary">
						<h4 class="modalHeader mb-1" id="modalExampleDemoLabel">신청내역 상세보기</h4>
					</div>
					<div class="p-4 pb-0">
						<!-- 승인 폼 -->
						<form action="/mediform/manager/employee/agree" method="post"
							id="agreeForm">
							<input type="hidden" id="cfEmpNo" name="empNo" value=""> 
							<input type="hidden" id="cfEmpSeInput" name="empSe" value=""> 
							<input type="hidden" id="cfEmpEmail" name="empEmail" value="">
							<sec:csrfInput />
						</form>
						<div class="text-center">
	                    	<img class="profileImg rounded-circle img-thumbnail shadow-sm" width="150" height="150" src="/resources/image/profile/profileImg.png" alt="User profile picture" id="cfEmpProfile">
	                    </div>
						<div class="mb-3 form-group">
							<label class="col-form-label" for=cfEmpNm>이름</label> 
							<input class="form-control" id="cfEmpNm" type="text" name="" readonly="readonly" />
						</div>
						<div class="mb-3 form-group">
							<label class="col-form-label" for="cfEmpSe">소속</label> 
							<input class="form-control" id="cfEmpSe" type="text" name="" readonly="readonly" />
						</div>
						<div class="mb-3 form-group">
							<label class="col-form-label" for="cfEmpRrno">주민등록번호</label> 
							<input class="form-control" id="cfEmpRrno" type="text" name="" readonly="readonly" />
						</div>
						<div class="mb-3 form-group">
							<label class="col-form-label" for="cfEmpTelno">연락처</label>
							 <input class="form-control" id="cfEmpTelno" type="text" name="" readonly="readonly" />
						</div>
						<div class="mb-3 form-group">
							<label class="col-form-label" for="cfEmpAdres">주소</label> 
							<input class="form-control" id="cfEmpAdres" type="text" name="" readonly="readonly" />
						</div>
						<div class="mb-3 form-group">
							<label class="col-form-label" for="cfEmpSexdstn">성별</label> 
							<input class="form-control" id="cfEmpSexdstn" type="text" name="" readonly="readonly" />
						</div>
						<div class="mb-3 form-group">
							<label class="col-form-label" for="cfEmpEmailInput">이메일</label> 
							<input class="form-control" id="cfEmpEmailInput" type="text" name="empEmail" readonly="readonly" />
						</div>
						<div class="mb-3 form-group">
							<label class="col-form-label" for="cfEmpRqstr">등록자사번</label> 
							<input class="form-control" id="cfEmpRqstr" type="text" name="" readonly="readonly" />
						</div>
						<div class="mb-3 form-group">
							<label class="col-form-label" for="cfEmpRqstrNm">등록자명</label> 
							<input class="form-control" id="cfEmpRqstrNm" type="text" name="" readonly="readonly" />
						</div>
					</div>
				</div>
				<div class="modal-footer">
					<button class="btn btn-secondary" type="button" id="agreeBtn">승인</button>
					<button class="btn btn-primary" type="button" id="rejectBtn">반려</button>
					<!-- 닫기 버튼 활성화 속성 : data-bs-dismiss="modal" -->
				</div>
			</div>
		</div>
	</div>
	<!-- 2 신청 내역 모달 탬플릿 끝 -->

	<!-- 3  신청 내역 모달 탬플릿 시작 -->
	<div class="modal fade" id="completeDetail-modal" tabindex="-1"
		role="dialog" aria-hidden="true">
		<div class="modal-dialog modal-dialog-centered" role="document"
			style="max-width: 500px">
			<div class="modal-content position-relative">
				<div class="position-absolute top-0 end-0 mt-2 me-2 z-1">
					<button
						class="btn-close btn btn-sm btn-circle d-flex flex-center transition-base"
						data-bs-dismiss="modal" aria-label="Close"></button>
				</div>
				<div class="modal-body p-0">
					<div class="rounded-top-3 py-3 ps-4 pe-6 bg-body-tertiary">
						<h4 class="modalHeader mb-1" id="modalExampleDemoLabel">처리내역 상세보기</h4>
					</div>
					<div class="p-4 pb-0">
						<div class="text-center">
	                    	<img class="profileImg rounded-circle img-thumbnail shadow-sm" width="150" height="150" src="/resources/image/profile/profileImg.png" alt="User profile picture" id="comEmpProfile">
	                    </div> 
						<div class="mb-3 form-group">
							<label class="col-form-label" for=comEmpNm>이름</label> 
							<input class="form-control" id="comEmpNm" type="text" name="" readonly="readonly" />
						</div>
						<div class="mb-3 form-group">
							<label class="col-form-label" for="comEmpSe">소속</label> 
							<input class="form-control" id="comEmpSe" type="text" name="" readonly="readonly" />
						</div>
						<div class="mb-3 form-group">
							<label class="col-form-label" for="comEmpRrno">주민등록번호</label> 
							<input class="form-control" id="comEmpRrno" type="text" name="" readonly="readonly" />
						</div>
						<div class="mb-3 form-group">
							<label class="col-form-label" for="comEmpTelno">연락처</label>
							 <input class="form-control" id="comEmpTelno" type="text" name="" readonly="readonly" />
						</div>
						<div class="mb-3 form-group">
							<label class="col-form-label" for="comEmpAdres">주소</label> 
							<input class="form-control" id="comEmpAdres" type="text" name="" readonly="readonly" />
						</div>
						<div class="mb-3 form-group">
							<label class="col-form-label" for="comEmpSexdstn">성별</label> 
							<input class="form-control" id="comEmpSexdstn" type="text" name="" readonly="readonly" />
						</div>
						<div class="mb-3 form-group">
							<label class="col-form-label" for="comEmpEmail">이메일</label> 
							<input class="form-control" id="comEmpEmail" type="text" name="empEmail" readonly="readonly" />
						</div>
						
						<label class="col-form-label" for="comEmpConfm">승인여부</label> <br>
        				<input class="form-check-input" id="comEmpConfm1" type="radio" name="comEmpConfm" value="1" > 승인 <br>
        				<input class="form-check-input" id="comEmpConfm2" type="radio" name="comEmpConfm" value="0" > 반려 <br><br>
						
						<div class="mb-3 form-group">
							<label class="col-form-label" for="comRjctResn">반려사유</label> 
							<input class="form-control" id="comRjctResn" type="text" name="" readonly="readonly" />
						</div>
					</div>
				</div>
				<div class="modal-footer">
					<button class="btn btn-primary" type="button" data-bs-dismiss="modal">닫기</button>
					<!-- 닫기 버튼 활성화 속성 : data-bs-dismiss="modal" -->
				</div>
			</div>
		</div>
	</div>
	<!-- 3 신청 내역 모달 탬플릿 끝 -->


	<!-- 반려사유 모달  탬플릿 시작 -->
	<div class="modal fade" id="reject-modal" tabindex="-1" role="dialog"
		aria-hidden="true">
		<div class="modal-dialog modal-dialog-centered" role="document"
			style="max-width: 500px">
			<div class="modal-content position-relative">
				<div class="position-absolute top-0 end-0 mt-2 me-2 z-1">
					<button
						class="btn-close btn btn-sm btn-circle d-flex flex-center transition-base"
						data-bs-dismiss="modal" aria-label="Close"></button>
				</div>
				<div class="modal-body p-0">
					<div class="rounded-top-3 py-3 ps-4 pe-6 bg-body-tertiary">
						<h4 class="mb-1" id="modalExampleDemoLabel">반려</h4>
					</div>
					<div class="p-4 pb-0">
						<div class="mb-3 form-group">
							<form action="/mediform/manager/employee/rejectUpdate"
								method="post" id="rejectForm">
								<input type="hidden" id="rejectEmpNo" name="empNo"> 
								<input type="hidden" id="rejectEmpEmail" name="empEmail" value="">
								<label class="col-form-label" for="reason">반려사유</label> 
								<input class="form-control" id="reason" type="text" name="RjctResn" placeholder="반려사유를 입력해 주세요." />
								<sec:csrfInput />
							</form>
						</div>
					</div>
				</div>
				<div class="modal-footer">
					<button class="btn btn-secondary" type="button" id="rejectUpdate">등록</button>
					<!-- 닫기 버튼 활성화 속성 : data-bs-dismiss="modal" -->
					<button class="btn btn-primary" type="button" data-bs-dismiss="modal">취소</button>
				</div>
			</div>
		</div>
	</div>
	<!-- 반려사유 모달 탬플릿 끝 -->

	<!-- 메세지 안내 모달 탬플릿 시작 -->
	<div class="modal fade" id="msg-modal" tabindex="-1" role="dialog"
		aria-hidden="true">
		<div class="modal-dialog modal-dialog-centered" role="document"
			style="max-width: 500px">
			<div class="modal-content position-relative">
				<div class="position-absolute top-0 end-0 mt-2 me-2 z-1">
					<button
						class="btn-close btn btn-sm btn-circle d-flex flex-center transition-base"
						data-bs-dismiss="modal" aria-label="Close"></button>
				</div>
				<div class="modal-body p-0">
					<div class="rounded-top-3 py-3 ps-4 pe-6 bg-body-tertiary">
						<h4 class="mb-1" id="modalExampleDemoLabel">처리 결과</h4>
					</div>
					<div class="p-4 pb-0">
						<span class="text-center" id="msgArea"></span>
					</div>
				</div>
				<div class="modal-footer">
					<button class="btn btn-primary" type="button" data-bs-dismiss="modal" id="">확인</button>
				</div>
			</div>
		</div>
	</div>
	<!-- 반려사유 탬플릿 끝 -->

	<script type="text/javascript">
		$(function() {
			$(document).ready(function() {
		    	msgFunction(); 
		    });

			// 넘어온 메세지 값이 있을 시 안내 모달창 발생
			function msgFunction(){
				var msg = $('#msg').val();
				console.log(msg);
				if (msg != null && msg != "") {
					$('#msgArea').text(msg);
					$('#msg-modal').modal("show");
				}
			}
			
			// 보고 있는 내역에 따른 페이징 아이디 변경***
			var flagSelect = $('#flagSelect').val();
			if(flagSelect == 'employee'){
				$(".pagingArea").attr("id", "empPagingArea");
				var empPagingArea = $('#empPagingArea');
				
				empPagingArea.on("click", "a", function(){
					event.preventDefault();
					var pageNo = $(this).data("page");
					$('#empListForm').find("#empPage").val(pageNo);
					$('#empListForm').submit();
				});
				
			}else if(flagSelect == 'confirm'){
				$(".pagingArea").eq(1).attr("id", "confirmPagingArea");
				var confirmPagingArea = $('#confirmPagingArea');
				
				confirmPagingArea.on("click", "a", function(){
					event.preventDefault();
					var pageNo = $(this).data("page");
					$('#confirmListForm').find("#conPage").val(pageNo);
					$('#confirmListForm').submit();
				});
				
			}else if(flagSelect == 'complete'){
				$(".pagingArea").eq(2).attr("id", "completePagingArea");
				var completePagingArea = $('#completePagingArea');
				
				completePagingArea.on("click", "a", function(){
					event.preventDefault();
					var pageNo = $(this).data("page");
					$('#completeListForm').find("#comPage").val(pageNo);					
					$('#completeListForm').submit();
				});
			}
			
			// 희망하는 리스트 클릭시 typeList 값 변경 후 submit
			$('#employee2').on('click', function(event){
				event.preventDefault();
				$('#empListForm').submit();
			});
			$('#confirm').on('click', function(event){
				event.preventDefault();
				$('#confirmListForm').submit();
			});
			
			//처리내역 탭 클릭
			$('#complete').on('click', function(event){
				event.preventDefault();
				$('#completeListForm').submit();
			});
			
			// 검색 후 엔터를 누르면 submit
			$("#empSearchInput").on("keydown", function(event) {
		        if (event.key === "Enter") {
		            event.preventDefault(); // 기본 Enter 동작 방지
		            $("#empListForm").submit(); 
		        }
		    });
			
			$("#conSearchInput").on("keydown", function(event) {
		        if (event.key === "Enter") {
		            event.preventDefault(); // 기본 Enter 동작 방지
		            $("#confirmListForm").submit(); 
		        }
		    });
			
			$("#comSearchInput").on("keydown", function(event) {
		        if (event.key === "Enter") {
		            event.preventDefault(); // 기본 Enter 동작 방지
		            $("#completeListForm").submit(); 
		        }
		    });
			
			// 타임스탬프 날짜 변환 함수(시,분,초 포함)
			function formatDate(timeStamp){
			    var date = new Date(timeStamp);

			    var year = date.getFullYear();
			    var month = (date.getMonth() + 1).toString().padStart(2, '0'); // 월은 0부터 시작하므로 1을 더하고, 두 자리로 만듭니다.
			    var day = date.getDate().toString().padStart(2, '0'); // 일도 두 자리로 만듭니다.
			    var hours = date.getHours().toString().padStart(2, '0'); // 시도 두 자리로 만듭니다.
			    var minutes = date.getMinutes().toString().padStart(2, '0'); // 분도 두 자리로 만듭니다.
			    var seconds = date.getSeconds().toString().padStart(2, '0'); // 초도 두 자리로 만듭니다.

			    var formattedDate = year + '-' + month + '-' + day + ' ' + hours + ':' + minutes + ':' + seconds;

			    return formattedDate;
			}
			
			function formatDateNoTime(timeStamp){
			    var date = new Date(timeStamp);
			    
			    var year = date.getFullYear();
			    var month = (date.getMonth() + 1).toString().padStart(2, '0'); // 월은 0부터 시작하므로 1을 더하고, 문자열로 변환하여 두 자리로 만듭니다.
			    var day = date.getDate().toString().padStart(2, '0'); // 일도 마찬가지로 두 자리로 만듭니다.
			    
			    var formattedDate = year + '-' + month + '-' + day;
			    
			    return formattedDate;
			}
			
			// 직원 조회(셀렉트 박스 값 변경시 리스트 변경)
			var empSelectBox = $('#empSelectBox');
			empSelectBox.on('change', function(){
				$('#empListForm').submit();
			});
			
			var comSelectBox = $('#comSelectBox');
			comSelectBox.on('change', function(){
				$('#completeListForm').submit();
			});
			
// 			$("#tab-dom-9e7952b7-b2ff-4974-9cd2-96ba32df3067").click();
			// 작업 처리 후 보고있던 리스트로 커서 이동
			var thisPage = $('#thisPage').val();
			if(thisPage != null && thisPage == "confirmList"){
// 				console.log("thisPage == confirmList");
// 				$("#confirm").click();
			}
			
			var token = $("input[name='_csrf']").val();
			var header = $("input[name='_csrf_header']").val();

			// # 조회 내용 변경시
			var selectList = $('#selectList');

			selectList.on('change', function() {

				var optionVal = selectList.val();
// 				console.log("optionVal : ", optionVal);

				var data = {
					optionVal : optionVal
				};

			});
			
			// 처리 내역 상세 조회 ajax
			var completeDetail = $('.completeDetail');
			
			completeDetail.on('click', function(){
				
				var empNo = $(this).attr('id');
				var data = {
					empNo : empNo  	
				};
				
				$.ajax({
					type : "post",
					url : "/mediform/manager/employee/getEmployee",
					data : JSON.stringify(data),
					contentType : "application/json; charset=utf-8",
					async : false,
					beforeSend : function(xhr) {
						xhr.setRequestHeader(header, token);
					},
					success : function(emp) {
// 						console.log(emp);

						var empNm = emp.empNm;
						var empRrno = emp.empRrno1 + "-" + emp.empRrno2;
						var empSeCd = emp.empSe;
						var empSeName = "";
						if (empSeCd == "d") {
							empSeName = "전문의";
						} else if (empSeCd == "n") {
							empSeName = "간호"
						} else if (empSeCd == "t") {
							empSeName = "치료"
						} else if (empSeCd == "m") {
							empSeName = "관리"
						} else if (empSeCd == "a") {
							empSeName = "원무"
						} else if (empSeCd == "k") {
							empSeName = "병원장"
						}
						var empTelno = emp.empTelno;
						var empAdres = emp.empAdres1 + " " + emp.empAdres2;
						var empSexdstn = emp.empSexdstn;
						var empSexdstnName = "";
						if (empSexdstn == "F") {
							empSexdstnName = "여자";
						} else {
							empSexdstnName = "남자";
						}
						var empEmail = emp.empEmail;
						var empConfm = emp.empConfm;
						var rjctResn = emp.rjctResn;
						var empProfile = emp.empProfile;

						// 모달창에 해당 상세 정보 넣기
						if(empProfile != null){
							$('#comEmpProfile').attr("src", empProfile);
						}
						
						$('#comEmpNm').val(empNm);
						$('#comEmpSe').val(empSeName);
						$('#comEmpRrno').val(empRrno);
						$('#comEmpTelno').val(empTelno);
						$('#comEmpAdres').val(empAdres);
						$('#comEmpSexdstn').val(empSexdstnName);
						$('#comEmpEmail').val(empEmail);
						if(empConfm == "Y"){
							$('#comEmpConfm1').attr("checked", true);
						}else{
							$('#comEmpConfm2').attr("checked", true);
						}
						
						$('#comEmpConfm1').prop("disabled", true);
						$('#comEmpConfm2').prop("disabled", true);
						
						$('#comRjctResn').val(rjctResn);
					}
				});
				$("#completeDetail-modal").modal("show");
			});
			

			// # 신청 내역 상세 조회 
			var empDetail = $('.detail');
			var rejectBtn = $('#rejectBtn');
			var rejectUpdate = $('#rejectUpdate');
			var rejectForm = $('#rejectForm');
			
			empDetail.on('click', function() {
				
				// 해당 데이터의 값을 상세 조회 모달로 이동
				var empNo = $(this).attr("id");
				var data = {
					empNo : empNo
				};

				$.ajax({
					type : "post",
					url : "/mediform/manager/employee/getEmployee",
					data : JSON.stringify(data),
					contentType : "application/json; charset=utf-8",
					async : false,
					beforeSend : function(xhr) {
						xhr.setRequestHeader(header, token);
					},
					success : function(emp) {
// 						console.log("empNo : " + emp.empNo);

						var empNo = emp.empNo;
						var empNm = emp.empNm;
						var empRrno = emp.empRrno1 + "-" + emp.empRrno2;
						var empSeCd = emp.empSe;
						var empSeName = "";
						if (empSeCd == "d") {
							empSeName = "전문의";
						} else if (empSeCd == "n") {
							empSeName = "간호"
						} else if (empSeCd == "t") {
							empSeName = "치료"
						} else if (empSeCd == "m") {
							empSeName = "관리"
						} else if (empSeCd == "a") {
							empSeName = "원무"
						} else if (empSeCd == "k") {
							empSeName = "병원장"
						}
						var empTelno = emp.empTelno;
						var empAdres = emp.empAdres1 + " " + emp.empAdres2;
						var empSexdstn = emp.empSexdstn;
						var empSexdstnName = "";
						if (empSexdstn == "F") {
							empSexdstnName = "여자";
						} else {
							empSexdstnName = "남자";
						}
						var empEmail = emp.empEmail;
						var empRqstr = emp.empRqstr;
						var empProfile = emp.empProfile;

						// 모달창에 해당 상세 정보 넣기
						$('#rejectEmpNo').val(empNo);
						$('#cfEmpNo').val(empNo);
						$('#cfEmpNm').val(empNm);
						$('#cfEmpRrno').val(empRrno);
						$('#cfEmpSe').val(empSeName);
						$('#cfEmpSeInput').val(empSeCd);
						$('#cfEmpTelno').val(empTelno);
						$('#cfEmpAdres').val(empAdres);
						$('#cfEmpSexdstn').val(empSexdstnName);
						$('#cfEmpEmail').val(empEmail);
						$('#cfEmpEmailInput').val(empEmail);
						$('#rejectEmpEmail').val(empEmail);
						$('#cfEmpRqstr').val(empRqstr);
						
						// 프로필 사진이 비어있지 않으면
						if(empProfile != null){
							$('#cfEmpProfile').attr("src", empProfile);
						}
						
						var cfData = {
								empNo : empRqstr
							};
						
						$.ajax({
							type : "post",
							url : "/mediform/manager/employee/getEmployee",
							data : JSON.stringify(cfData),
							contentType : "application/json; charset=utf-8",
							async : false,
							beforeSend : function(xhr) {
								xhr.setRequestHeader(header, token);
							},
							success : function(rst) {
// 								console.log("2번째 ajax 출발")
// 								console.log("기안자 이름 : " + rst.empNm);
// 								console.log("2번째 ajax 끝")
								
								var empNm = rst.empNm;
								
								$('#cfEmpRqstrNm').val(empNm);
							}	
						});
						
					}
				});

				// 모달창 show
				$("#confirmDetail-modal").modal("show");

				var agreeBtn = $('#agreeBtn');
				// 승인 버튼 클릭시
				agreeBtn.on('click', function() {
					$('#agreeForm').submit();
				});

				// 반려 버튼 클릭시 반려 사유 모달 show
				rejectBtn.on('click', function() {
					$("#memberDetail-modal").modal("hide");
					$("#reject-modal").modal("show");
				});

				// 반려 사유 기재시 최종 반려 처리 완료
				rejectUpdate.on('click', function() {
					var reason = $('#reason');
					if (reason != null) {
						rejectForm.submit();
					}
				});

			});

			// 직원 목록 상세조회
			var selectDetail = $('.selectDetail');

			selectDetail.on('click', function() {
				// 사용한 모달 요소 초기화
				$('#retireCheckboxO').prop("disabled", false);
				$('#retireCheckboxX').prop("disabled", false);
				$('#empClsf0').prop("disabled", false);
				$('#empClsf1').prop("disabled", false);
				$('#empRetireInput').val(null);

				// 해당 데이터의 값을 상세 조회 모달로 이동
				var empNo = $(this).attr("id");
				var data = {
					empNo : empNo
				};

				$.ajax({
					type : "post",
					url : "/mediform/manager/employee/getEmployee",
					data : JSON.stringify(data),
					contentType : "application/json; charset=utf-8",
					async : false,
					beforeSend : function(xhr) {
						xhr.setRequestHeader(header, token);
					},
					success : function(emp) {
// 						console.log("empNo : " + emp.empNo);

						var empNo = emp.empNo;
						var empNm = emp.empNm;
						var empRrno = emp.empRrno1 + "-" + emp.empRrno2;
						var empSeCd = emp.empSe;
						var empSeName = "";
						if (empSeCd == "d") {
							empSeName = "전문의";
						} else if (empSeCd == "n") {
							empSeName = "간호"
						} else if (empSeCd == "t") {
							empSeName = "치료"
						} else if (empSeCd == "m") {
							empSeName = "관리"
						} else if (empSeCd == "a") {
							empSeName = "원무"
						} else if (empSeCd == "k") {
							empSeName = "병원장"
						}
						var empTelno = emp.empTelno;
						var empAdres = emp.empAdres1 + " " + emp.empAdres2;
						var empSexdstn = emp.empSexdstn;
						var empSexdstnName = "";
						if (empSexdstn == "F") {
							empSexdstnName = "여자";
						} else {
							empSexdstnName = "남자";
						}
						var empEmail = emp.empEmail;
						var empRetire = emp.empRetire;
						var empClsf = emp.empClsf;
						var empHffcAt = emp.empHffcAt;
						var empEncpn = emp.empEncpn;
						var empProfile = emp.empProfile;
// 						console.log("empHffcAt : " + empHffcAt );

						// 모달창에 해당 상세 정보 넣기
						console.log("empNo : " + empNo);
						$('#rejectEmpNo').val(empNo);
						$('#empNoInput').val(empNo);
						$('#empNo').val(empNo);
						$('#empNoUpdate').val(empNo);
						$('#empNm').val(empNm);
						$('#empRrno').val(empRrno);
						$('#empSe').val(empSeName);
						$('#empSeUpdate').val(empSeCd);
						$('#empTelno').val(empTelno);
						$('#empAdres').val(empAdres);
						$('#empSexdstn').val(empSexdstnName);
						$('#empEmail').val(empEmail);
						$('#empEmailInput').val(empEmail);
						$('#rejectEmpEmail').val(empEmail);
						var formatEmpEncpn = formatDateNoTime(empEncpn);
						$('#empEncpn').val(formatEmpEncpn);
						
						// 프로필 사진이 비어있지 않으면
						if(empProfile != null){
							$('#empProfile').attr("src", empProfile);
						}

						if(empClsf == "0"){
							$('#empClsf0').attr("checked", true);
						}else{
							$('#empClsf1').attr("checked", true);
						}

						if (empHffcAt == "N") {
							$('#retireCheckboxX').attr("checked", true);
							$('#retireCheckboxO').prop("disabled", true);
							$('#retireCheckboxX').prop("disabled", true);
							$('#empClsf0').prop("disabled", true);
							$('#empClsf1').prop("disabled", true);
							
							
							var formattedDate = formatDate(empRetire);
							$('#empRetireInput').val(formattedDate);
						} else if(empHffcAt == "Y"){
							$('#retireCheckboxX').attr("checked", false);
							$('#retireCheckboxO').prop("checked", true);
						}
					}
				});

				// 모달창 show
				$("#memberDetail-modal").modal("show");

				// 수정 버튼 클릭시	
				$('#modifyEmpBtn').on('click', function(event) {
				    var modifyForm = $('#modifyForm');
				    var retireCheckboxO = $('#retireCheckboxO');

				    // 이미 퇴직한 직원은 수정 불가
				    if (retireCheckboxO.prop("disabled")) {
				        event.preventDefault();
				        var msg = "퇴직한 직원의 내용은 수정할 수 없습니다.";
				        $('#msgArea').text(msg);
						$('#msg-modal').modal("show");
						$('#msgModalCloseBtn').on('click', function(){
							// 사용한 요소들 모두 초기화
					        $('#msgArea').text(null);
							$('#retireCheckboxO').attr("checked", false);
							$('#retireCheckboxO').prop("disabled", false);
							$('#retireCheckboxX').prop("disabled", false);
							$('#empClsf0').prop("disabled", false);
							$('#empClsf1').prop("disabled", false);
						});
				    } else {
				        modifyForm.submit();
				    }
				});
			});

		});
	</script>
</body>
</html>
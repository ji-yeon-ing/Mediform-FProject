<%@ page language="java" contentType="text/html; charset=UTF-8"  pageEncoding="UTF-8"%>
<%@ taglib uri="http://www.springframework.org/security/tags" prefix="sec" %>

<!DOCTYPE html>
<html data-bs-theme="light" lang="en-US" dir="ltr">

<body>

	<!-- ===============================================-->
	<!--    Main Content-->
	<!-- ===============================================-->
	<main class="main" id="top">
		<div class="container" data-layout="container">
			<script>
				var isFluid = JSON.parse(localStorage.getItem('isFluid'));
				if (isFluid) {
					var container = document.querySelector('[data-layout]');
					container.classList.remove('container');
					container.classList.add('container-fluid');
				}
			</script>

			<div class="content">

				<div class="card overflow-hidden">
					<div class="card-header">
						<div class="row gx-0 align-items-center">
							<div class="col-auto d-flex justify-content-end order-md-1">
								<button
									class="btn icon-item icon-item-sm shadow-none p-0 me-1 ms-md-2"
									type="button" data-event="prev" data-bs-toggle="tooltip"
									title="Previous">
									<span class="fas fa-arrow-left"></span>
								</button>
								<button
									class="btn icon-item icon-item-sm shadow-none p-0 me-1 me-lg-2"
									type="button" data-event="next" data-bs-toggle="tooltip"
									title="Next">
									<span class="fas fa-arrow-right"></span>
								</button>
							</div>
							<div class="col-auto col-md-auto order-md-2">
								<h4 class="mb-0 fs-0 fs-sm-1 fs-lg-2 calendar-title"></h4>
							</div>
							<div
								class="col col-md-auto d-flex justify-content-end order-md-3">
								<button class="btn btn-falcon-primary btn-sm" type="button"
									data-event="today">Today</button>
							</div>
							<div class="col-md-auto d-md-none">
								<hr />
							</div>
							<div class="col-auto d-flex order-md-0">
								<button class="btn btn-primary btn-sm" type="button"
									data-bs-toggle="modal" data-bs-target="#addEventModal">
									<span class="fas fa-plus me-2"></span>Add Schedule
								</button>
							</div>
							<div class="col d-flex justify-content-end order-md-2">
								<div class="dropdown font-sans-serif me-md-2">
									<button
										class="btn btn-falcon-default text-600 btn-sm dropdown-toggle dropdown-caret-none"
										type="button" id="email-filter" data-bs-toggle="dropdown"
										data-boundary="viewport" aria-haspopup="true"
										aria-expanded="false">
										<span data-view-title="data-view-title">Month View</span><span
											class="fas fa-sort ms-2 fs--1"></span>
									</button>
									<div class="dropdown-menu dropdown-menu-end border py-2"
										aria-labelledby="email-filter">
										<a class="active dropdown-item d-flex justify-content-between"
											href="#!" data-fc-view="dayGridMonth">Month View<span
											class="icon-check"><span class="fas fa-check"
												data-fa-transform="down-4 shrink-4"></span></span></a><a
											class="dropdown-item d-flex justify-content-between"
											href="#!" data-fc-view="timeGridWeek">Week View<span
											class="icon-check"><span class="fas fa-check"
												data-fa-transform="down-4 shrink-4"></span></span></a><a
											class="dropdown-item d-flex justify-content-between"
											href="#!" data-fc-view="timeGridDay">Day View<span
											class="icon-check"><span class="fas fa-check"
												data-fa-transform="down-4 shrink-4"></span></span></a><a
											class="dropdown-item d-flex justify-content-between"
											href="#!" data-fc-view="listWeek">List View<span
											class="icon-check"><span class="fas fa-check"
												data-fa-transform="down-4 shrink-4"></span></span></a><a
											class="dropdown-item d-flex justify-content-between"
											href="#!" data-fc-view="listYear">Year View<span
											class="icon-check"><span class="fas fa-check"
												data-fa-transform="down-4 shrink-4"></span></span></a>
									</div>
								</div>
							</div>
						</div>
					</div>
					<div class="card-body p-0 scrollbar">
						<div class="calendar-outline" id="appCalendar"></div>
					</div>
				</div>
			</div>
			<div class="modal fade" id="authentication-modal" tabindex="-1"
				role="dialog" aria-labelledby="authentication-modal-label"
				aria-hidden="true">
				<div class="modal-dialog mt-6" role="document">
					<div class="modal-content border-0">
						<div
							class="modal-header px-5 position-relative modal-shape-header bg-shape">
							<div class="position-relative z-1">
								<h4 class="mb-0 text-white" id="authentication-modal-label">Register</h4>
								<p class="fs--1 mb-0 text-white">Please create your free
									Falcon account</p>
							</div>
							<button class="btn-close position-absolute top-0 end-0 mt-2 me-2"
								data-bs-dismiss="modal" aria-label="Close"></button>
						</div>
						<div class="modal-body py-4 px-5">
							<form>
								<div class="mb-3">
									<label class="form-label" for="modal-auth-name">Name</label> <input
										class="form-control" type="text" autocomplete="on"
										id="modal-auth-name" />
								</div>
								<div class="mb-3">
									<label class="form-label" for="modal-auth-email">Email
										address</label> <input class="form-control" type="email"
										autocomplete="on" id="modal-auth-email" />
								</div>
								<div class="row gx-2">
									<div class="mb-3 col-sm-6">
										<label class="form-label" for="modal-auth-password">Password</label>
										<input class="form-control" type="password" autocomplete="on"
											id="modal-auth-password" />
									</div>
									<div class="mb-3 col-sm-6">
										<label class="form-label" for="modal-auth-confirm-password">Confirm
											Password</label> <input class="form-control" type="password"
											autocomplete="on" id="modal-auth-confirm-password" />
									</div>
								</div>
								<div class="form-check">
									<input class="form-check-input" type="checkbox"
										id="modal-auth-register-checkbox" /> <label
										class="form-label" for="modal-auth-register-checkbox">I
										accept the <a href="#!">terms </a>and 
										<a class="white-space-nowrap" href="#!">privacy policy</a>
									</label>
								</div>
								<div class="mb-3">
									<button class="btn btn-primary d-block w-100 mt-3"
										type="submit" name="submit">Register</button>
								</div>
							</form>
							<div class="position-relative mt-5">
							
								<hr />
								<div class="divider-content-center">or register with</div>
							</div>
							<div class="row g-2 mt-2">
								<div class="col-sm-6">
									<a class="btn btn-outline-google-plus btn-sm d-block w-100"
										href="#"><span class="fab fa-google-plus-g me-2"
										data-fa-transform="grow-8"></span> google</a>
								</div>
								<div class="col-sm-6">
									<a class="btn btn-outline-facebook btn-sm d-block w-100"
										href="#"><span class="fab fa-facebook-square me-2"
										data-fa-transform="grow-8"></span> facebook</a>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="modal fade" id="eventDetailsModal" tabindex="-1">
				<div class="modal-dialog modal-dialog-centered">
					<div class="modal-content border"></div>
				</div>
			</div>
			<div class="modal fade" id="addEventModal" tabindex="-1">
				<div class="modal-dialog">
					<div class="modal-content border">


							<!--Create Schedule  생성 칸-->
						
						<form action="/addEventForm" id="addEventForm" method="post" > <!--  autocomplete: "on" 자동완성 기능  -->
							<div class="modal-header px-x1 bg-body-tertiary border-bottom-0">
								<h5 class="modal-title">스케줄 예약 관리</h5>
								<button class="btn-close me-n1" type="button" data-bs-dismiss="modal" aria-label="Close"></button>
							</div>
							
								<input type="hidden" name="schdlCd" id="schdlCd">
								<input type="hidden" name="pstgDt" id="pstgDt">
							<div class="modal-body p-x1">
								<div class="mb-3">
									<label class="fs-0" for="eventTitle">일정 제목</label> 
									<input class="form-control" type="text" name="schdlNm" id="schdlNm" required="required" />
								</div>
								<div class="mb-3">
									<label class="fs-0" for="eventStartDate">시작일</label> 
									<input class="form-control datetimepicker" id="schdlBgngDt"
										type="text" required="required" name="schdlBgngDt"
										placeholder="yyyy/mm/dd hh:mm"
										data-options='{"static":"true","enableTime":"true","dateFormat":"Y-m-d H:i"}' />
								</div>
								<div class="mb-3">
									<label class="fs-0" for="eventEndDate">종료일</label> 
									<input class="form-control datetimepicker" id="schdlEndDt"
										type="text" name="schdlEndDt" placeholder="yyyy/mm/dd hh:mm"
										data-options='{"static":"true","enableTime":"true","dateFormat":"Y-m-d H:i"}' />
								</div>
								<div class="form-check">
									<input class="form-check-input" type="checkbox"
										id="eventAllDay" name="allDay" /> 
									<label class="form-check-label" for="eventAllDay">All Day</label>
								</div>
								<div class="mb-3">
<!-- 									<label class="fs-0">Schedule Meeting</label> -->
									<div>
										<!-- 템플릿에 들어있던거임 
										<a class="btn badge-subtle-success btn-sm" href="#!"><span
											class="fas fa-video me-2"></span>Add video conference link</a> -->
									</div>
								</div>
								<div class="mb-3">
									<label class="fs-0" for="eventDescription">메모 사항</label>
									<textarea class="form-control" rows="3" name="schdlCn" id="schdlCn"></textarea>
								</div>
								<div class="mb-3">
									<label class="fs-0" for="eventLabel">색깔</label> 
									<select class="form-select" id="schdlColor" name="schdlColor">
										<option value="" selected="selected">None</option>
										<option value="primary">Business</option>
										<option value="danger">Important</option>
										<option value="success">Personal</option>
										<option value="warning">Must Attend</option>
									</select>
								</div>
							</div>
							<div
								class="modal-footer d-flex justify-content-end align-items-center bg-body-tertiary border-0">
<%-- 	템플릿에 들어있던거임  	<a class="me-3 text-600" href="${pageContext.request.contextPath }/resources/app/events/create-an-event.html">More options</a> --%>
								
								<button class="btn btn-primary px-4" id="eventBtn">Save</button>
							</div>
							<sec:csrfInput/>   
						</form>

							<!--Create Schedule  생성 칸 끝 -->

					</div>
				</div> 
			</div>
		</div>
	</main>
	<!-- ===============================================-->
	<!--    End of Main Content-->
	<!-- ===============================================-->
</body>
<meta id="_csrf" name="_csrf" content="${_csrf.token}"/>
<meta id="_csrf_header" name="_csrf_header" content="${_csrf.headerName}"/>

<script type="text/javascript">
$(document).ready(function(){	
	
	var eventBtn =  $("#eventBtn");
	var token = $("meta[name='_csrf']").attr("content");
	var header = $("meta[name='_csrf_header']").attr("content");
	
	
	console.log("실횅되라");
	$.ajax({
		type : "post",
		url : "/mediform/scheduler/eventList",
		data : {},
		dataType: 'json',
		contentType : "application/json; charset = utf-8",
		async: false,
        beforeSend : function(xhr){            
            xhr.setRequestHeader(header,token);
        },
		success: function(param) {
			 var events = [];
	            console.log(param);
	            $.each(param, function (index, data){
	                console.log(data);
	                if(data.pValue != null && data.pValue === 'private'){
	                    events.push({
	                        title : data.title
	                        ,start : data.start
	                        ,end : data.end
	                        ,color : 'red'
	                    });
	                }else if(data.pValue != null && data.pValue === 'public'){
	                    events.push({
	                        title : data.title
	                        ,start : data.start
	                        ,end : data.end
	                        ,color : 'blue'
	                    });
	                }else{
	                    events.push({
	                        title : data.title
	                        ,start : data.start
	                        ,end : data.end
	                        ,color : 'green'
	                    });
	                }
	            })
	            successCallback(events);
	        }
	});
	
	
});

$(function () {

	var eventBtn =  $("#eventBtn");
	var token = $("meta[name='_csrf']").attr("content");
	var header = $("meta[name='_csrf_header']").attr("content");
	
	
	eventBtn.on("click", function() {
		var schdlCd = $("#schdlCd").val();
		var pstgDt = $("#pstgDt").val();
		var schdlNm = $("#schdlNm").val();
		var schdlBgngDt = $("#schdlBgngDt").val();
		var schdlEndDt = $("#schdlEndDt").val();
		var schdlCn = $("#schdlCn").val();
		var schdlColor = $("#schdlColor").val();
		
		var schdlObject = {
				schdlCd : schdlCd,
				pstgDt : pstgDt,
				schdlNm : schdlNm,
				schdlBgngDt : schdlBgngDt,
				schdlEndDt : schdlEndDt,
				schdlCn : schdlCn,
				schdlColor : schdlColor
		}
		
		$.ajax({
			type : "post",
			url : "/mediform/scheduler/addEventForm",
			data : JSON.stringify(schdlObject),
			contentType : "application/json; charset = utf-8",
			async: false,
	        beforeSend : function(xhr){            
	            xhr.setRequestHeader(header,token);
	        },
			success: function(result) {
				console.log("result:"+ result);
				let url = '/mediform/scheduler/main';
				location.replace(url);
				alert("저장 성공!");
			},
			error : function() {
				alert(result+"실패");
			}
		});
	});
	
/* 	FullCalendar.globalLocales.push(function () {
		  'use strict';
		  
	
	}()); */
	
	
	


	var _window3 = window,
	  dayjs = _window3.dayjs;
	var currentDay = dayjs && dayjs().format('DD');
	var currentMonth = dayjs && dayjs().format('MM');
	var prevMonth = dayjs && dayjs().subtract(1, 'month').format('MM');
	var nextMonth = dayjs && dayjs().add(1, 'month').format('MM');
	var currentYear = dayjs && dayjs().format('YYYY');
	

	var events = [{
		  title: 'Boot Camp',
		  start: "".concat(currentYear, "-").concat(currentMonth, "-01 10:00:00"),
		  end: "".concat(currentYear, "-").concat(currentMonth, "-03 16:00:00"),
		  description: "Boston Harbor Now in partnership with the Friends of Christopher Columbus Park, the Wharf District Council and the City of Boston is proud to announce the New Year's Eve Midnight Harbor Fireworks! This beloved nearly 40-year old tradition is made possible by the generous support of local waterfront organizations and businesses and the support of the City of Boston and the Office of Mayor Marty Walsh.",
		  className: 'bg-success-subtle',
		  location: 'Boston Harborwalk, Christopher Columbus Park, <br /> Boston, MA 02109, United States',
		  organizer: 'Boston Harbor Now'
		}, {
		  title: 'Crain\'s New York Business ',
		  start: "".concat(currentYear, "-").concat(currentMonth, "-11"),
		  description: "Crain's 2020 Hall of Fame. Sponsored Content By Crain's Content Studio. Crain's Content Studio Presents: New Jersey: Perfect for Business. Crain's Business Forum: Letitia James, New York State Attorney General. Crain's NYC Summit: Examining racial disparities during the pandemic",
		  className: 'bg-primary-subtle'
		}, {
		  title: 'Conference',
		  start: "".concat(currentYear, "-").concat(currentMonth, "-").concat(currentDay),
		  description: 'The Milken Institute Global Conference gathered the best minds in the world to tackle some of its most stubborn challenges. It was a unique experience in which individuals with the power to enact change connected with experts who are reinventing health, technology, philanthropy, industry, and media.',
		  className: 'bg-success-subtle',
		  allDay: true,
		  schedules: [{
		    title: 'Reporting',
		    start: "".concat(currentYear, "-").concat(currentMonth, "-").concat(currentDay, " 11:00:00"),
		    description: 'Time to start the conference and will briefly describe all information about the event.  ',
		    className: 'event-bg-success-subtle'
		  }, {
		    title: 'Lunch',
		    start: "".concat(currentYear, "-").concat(currentMonth, "-").concat(currentDay, " 14:00:00"),
		    description: 'Lunch facility for all the attendance in the conference.',
		    className: 'event-bg-success-subtle'
		  }, {
		    title: 'Contest',
		    start: "".concat(currentYear, "-").concat(currentMonth, "-").concat(currentDay, " 16:00:00"),
		    description: 'The starting of the programming contest',
		    className: 'event-bg-success-subtle'
		  }, {
		    title: 'Dinner',
		    start: "".concat(currentYear, "-").concat(currentMonth, "-").concat(currentDay, " 22:00:00"),
		    description: 'Dinner facility for all the attendance in the conference',
		    className: 'event-bg-success-subtle'
		  }]
		}, {
		  title: "ICT Expo ".concat(currentYear, " - Product Release"),
		  start: "".concat(currentYear, "-").concat(currentMonth, "-16 10:00:00"),
		  description: "ICT Expo ".concat(currentYear, " is the largest private-sector exposition aimed at showcasing IT and ITES products and services in Switzerland."),
		  end: "".concat(currentYear, "-").concat(currentMonth, "-18 16:00:00"),
		  className: 'bg-warning-subtle'
		}, {
		  title: 'Meeting',
		  start: "".concat(currentYear, "-").concat(currentMonth, "-07 10:00:00"),
		  description: 'Discuss about the upcoming projects in current year and assign all tasks to the individuals'
		}, {
		  title: 'Contest',
		  start: "".concat(currentYear, "-").concat(currentMonth, "-14 10:00:00"),
		  description: 'PeaceX is an international peace and amity organisation that aims at casting a pall at the striking issues surmounting the development of peoples and is committed to impacting the lives of young people all over the world.'
		}, {
		  title: 'Event With Url',
		  start: "".concat(currentYear, "-").concat(currentMonth, "-23"),
		  description: 'Sample example of a event with url. Click the event, will redirect to the given link.',
		  className: 'bg-success-subtle',
		  url: 'http://google.com'
		}, {
		  title: 'Competition',
		  start: "".concat(currentYear, "-").concat(currentMonth, "-26"),
		  description: 'The Future of Zambia – Top 30 Under 30 is an annual award, ranking scheme, and recognition platform for young Zambian achievers under the age of 30, who are building brands, creating jobs, changing the game, and transforming the country.',
		  className: 'bg-danger-subtle'
		}, {
		  title: 'Birthday Party',
		  start: "".concat(currentYear, "-").concat(nextMonth, "-05"),
		  description: 'Will celebrate birthday party with my friends and family',
		  className: 'bg-primary-subtle'
		}, {
		  title: 'Click for Google',
		  url: 'http://google.com/',
		  start: "".concat(currentYear, "-").concat(prevMonth, "-10"),
		  description: 'Applications are open for the New Media Writing Prize 2020. The New Media Writing Prize (NMWP) showcases exciting and inventive stories and poetry that integrate a variety of formats, platforms, and digital media.',
		  className: 'bg-primary-subtle'
		}];

	
	
	
	
	
	
	
	
	

});
</script>
</html>